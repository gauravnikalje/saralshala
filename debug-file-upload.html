<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug File Upload</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-2xl mx-auto bg-white p-6 rounded-lg shadow-lg">
        <h1 class="text-2xl font-bold mb-6 text-center">Debug File Upload</h1>
        
        <div id="app" class="space-y-6">
            <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
                <input type="file" id="image-upload" accept="image/*" class="hidden">
                <label for="image-upload" class="cursor-pointer">
                    <div class="flex flex-col items-center justify-center">
                        <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-2"></i>
                        <p class="text-gray-600">Click to select an image</p>
                        <p class="text-sm text-gray-500 mt-1">or drag and drop</p>
                    </div>
                </label>
            </div>
            
            <div id="preview-container" class="hidden mt-4">
                <h3 class="font-medium mb-2">Preview:</h3>
                <img id="preview-image" alt="Preview" class="max-w-full h-auto rounded-lg shadow">
            </div>
            
            <div class="flex justify-center">
                <button id="upload-btn" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                    Upload Image
                </button>
            </div>
            
            <div id="result" class="hidden mt-4 p-4 rounded-lg"></div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const fileInput = document.getElementById('image-upload');
            const previewContainer = document.getElementById('preview-container');
            const previewImage = document.getElementById('preview-image');
            const uploadBtn = document.getElementById('upload-btn');
            const resultDiv = document.getElementById('result');
            
            // Handle file selection
            fileInput.addEventListener('change', function(event) {
                const file = event.target.files[0];
                if (file) {
                    console.log('File selected:', file);
                    const previewUrl = URL.createObjectURL(file);
                    previewImage.src = previewUrl;
                    previewContainer.classList.remove('hidden');
                    
                    // Show result
                    resultDiv.className = 'mt-4 p-4 rounded-lg bg-blue-100 text-blue-800';
                    resultDiv.textContent = 'File selected: ' + file.name;
                    resultDiv.classList.remove('hidden');
                }
            });
            
            // Handle upload button click
            uploadBtn.addEventListener('click', function() {
                const file = fileInput.files[0];
                if (!file) {
                    resultDiv.className = 'mt-4 p-4 rounded-lg bg-red-100 text-red-800';
                    resultDiv.textContent = 'Please select a file first';
                    resultDiv.classList.remove('hidden');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    const imageUrl = e.target.result;
                    
                    // Try to save to localStorage
                    try {
                        localStorage.setItem('debugImage', imageUrl);
                        resultDiv.className = 'mt-4 p-4 rounded-lg bg-green-100 text-green-800';
                        resultDiv.textContent = 'Image uploaded successfully! Saved to localStorage.';
                        resultDiv.classList.remove('hidden');
                    } catch (error) {
                        resultDiv.className = 'mt-4 p-4 rounded-lg bg-red-100 text-red-800';
                        resultDiv.textContent = 'Error saving image: ' + error.message;
                        resultDiv.classList.remove('hidden');
                    }
                };
                reader.readAsDataURL(file);
            });
        });
    </script>
</body>
</html>